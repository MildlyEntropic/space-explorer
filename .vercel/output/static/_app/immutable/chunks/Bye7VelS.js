import{x as ce,D as Ie,E as Me,F as fe,z as Y,G as be,H as He,j as N,I as Le,J as $e,K as Ne,L as ge,M as de,A as ne,N as Pe,O as Fe,P as xe,o as De,Q as P,y as pe,C as Oe,R as we,S as Ze,T as me,U as Ue,V as je,W as Ge,X as Ve,q as Ce,w as ye,Y as ve,Z as ze,_ as Be,a0 as Ke,a1 as Ye,v as qe,p as We,f as J,h as Xe,a2 as Je,m as ue,e as p,g as w,r as h,t as U}from"./CUvoXlMx.js";import{c as _e,a as T,f as F}from"./DziQLqqf.js";import{d as Qe,e as ea,s as H}from"./BcHQezlt.js";import{p as Ae,i as $}from"./D8CdmuON.js";import{s as q}from"./Bue3ZnWR.js";function ya(e,a){return a}function aa(e,a,r){for(var s=[],u=a.length,i,l=a.length,m=0;m<u;m++){let x=a[m];ye(x,()=>{if(i){if(i.pending.delete(x),i.done.add(x),i.pending.size===0){var f=e.outrogroups;he(me(i.done)),f.delete(i),f.size===0&&(e.outrogroups=null)}}else l-=1},!1)}if(l===0){var c=s.length===0&&r!==null;if(c){var o=r,n=o.parentNode;Ye(n),n.append(o),e.items.clear()}he(a,!c)}else i={pending:new Set(a),done:new Set},(e.outrogroups??=new Set).add(i)}function he(e,a=!0){for(var r=0;r<e.length;r++)qe(e[r],a)}var Ee;function ka(e,a,r,s,u,i=null){var l=e,m=new Map,c=(a&Me)!==0;if(c){var o=e;l=Y?fe(be(o)):o.appendChild(ce())}Y&&He();var n=null,x=Le(()=>{var d=r();return Ue(d)?d:d==null?[]:me(d)}),f,v=!0;function S(){t.fallback=n,ta(t,f,l,a,s),n!==null&&(f.length===0?(n.f&P)===0?Ce(n):(n.f^=P,Q(n,null,l)):ye(n,()=>{n=null}))}var R=Ie(()=>{f=N(x);var d=f.length;let D=!1;if(Y){var O=$e(l)===Ne;O!==(d===0)&&(l=ge(),fe(l),de(!1),D=!0)}for(var y=new Set,L=De,Z=Oe(),C=0;C<d;C+=1){Y&&ne.nodeType===Pe&&ne.data===Fe&&(l=ne,D=!0,de(!1));var _=f[C],A=s(_,C),g=v?null:m.get(A);g?(g.v&&xe(g.v,_),g.i&&xe(g.i,C),Z&&L.skipped_effects.delete(g.e)):(g=ra(m,v?l:Ee??=ce(),_,A,C,u,a,r),v||(g.e.f|=P),m.set(A,g)),y.add(A)}if(d===0&&i&&!n&&(v?n=pe(()=>i(l)):(n=pe(()=>i(Ee??=ce())),n.f|=P)),Y&&d>0&&fe(ge()),!v)if(Z){for(const[G,k]of m)y.has(G)||L.skipped_effects.add(k.e);L.oncommit(S),L.ondiscard(()=>{})}else S();D&&de(!0),N(x)}),t={effect:R,items:m,outrogroups:null,fallback:n};v=!1,Y&&(l=ne)}function ta(e,a,r,s,u){var i=(s&Ke)!==0,l=a.length,m=e.items,c=e.effect.first,o,n=null,x,f=[],v=[],S,R,t,d;if(i)for(d=0;d<l;d+=1)S=a[d],R=u(S,d),t=m.get(R).e,(t.f&P)===0&&(t.nodes?.a?.measure(),(x??=new Set).add(t));for(d=0;d<l;d+=1){if(S=a[d],R=u(S,d),t=m.get(R).e,e.outrogroups!==null)for(const g of e.outrogroups)g.pending.delete(t),g.done.delete(t);if((t.f&P)!==0)if(t.f^=P,t===c)Q(t,null,r);else{var D=n?n.next:c;t===e.effect.last&&(e.effect.last=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),j(e,n,t),j(e,t,D),Q(t,D,r),n=t,f=[],v=[],c=n.next;continue}if((t.f&ve)!==0&&(Ce(t),i&&(t.nodes?.a?.unfix(),(x??=new Set).delete(t))),t!==c){if(o!==void 0&&o.has(t)){if(f.length<v.length){var O=v[0],y;n=O.prev;var L=f[0],Z=f[f.length-1];for(y=0;y<f.length;y+=1)Q(f[y],O,r);for(y=0;y<v.length;y+=1)o.delete(v[y]);j(e,L.prev,Z.next),j(e,n,L),j(e,Z,O),c=O,n=Z,d-=1,f=[],v=[]}else o.delete(t),Q(t,c,r),j(e,t.prev,t.next),j(e,t,n===null?e.effect.first:n.next),j(e,n,t),n=t;continue}for(f=[],v=[];c!==null&&c!==t;)(o??=new Set).add(c),v.push(c),c=c.next;if(c===null)continue}(t.f&P)===0&&f.push(t),n=t,c=t.next}if(e.outrogroups!==null){for(const g of e.outrogroups)g.pending.size===0&&(he(me(g.done)),e.outrogroups?.delete(g));e.outrogroups.size===0&&(e.outrogroups=null)}if(c!==null||o!==void 0){var C=[];if(o!==void 0)for(t of o)(t.f&ve)===0&&C.push(t);for(;c!==null;)(c.f&ve)===0&&c!==e.fallback&&C.push(c),c=c.next;var _=C.length;if(_>0){var A=(s&Me)!==0&&l===0?r:null;if(i){for(d=0;d<_;d+=1)C[d].nodes?.a?.measure();for(d=0;d<_;d+=1)C[d].nodes?.a?.fix()}aa(e,C,A)}}i&&ze(()=>{if(x!==void 0)for(t of x)t.nodes?.a?.apply()})}function ra(e,a,r,s,u,i,l,m){var c=(l&je)!==0?(l&Ge)===0?Ze(r,!1,!1):we(r):null,o=(l&Ve)!==0?we(u):null;return{v:c,i:o,e:pe(()=>(i(a,c??r,o??u,m),()=>{e.delete(s)}))}}function Q(e,a,r){if(e.nodes)for(var s=e.nodes.start,u=e.nodes.end,i=a&&(a.f&P)===0?a.nodes.start:r;s!==null;){var l=Be(s);if(i.before(s),s===u)return;s=l}}function j(e,a,r){a===null?e.effect.first=r:a.next=r,r===null?e.effect.last=a:r.prev=a}const ke="https://mars.nasa.gov/rss/api/",Se="https://mars.nasa.gov/api/v1/raw_image_items/",na={NAVCAM_LEFT:"NAVCAM_LEFT",NAVCAM_RIGHT:"NAVCAM_RIGHT",MCZ_LEFT:"MCZ_LEFT",MCZ_RIGHT:"MCZ_RIGHT",FRONT_HAZCAM_LEFT_A:"FRONT_HAZCAM_LEFT_A",FRONT_HAZCAM_RIGHT_A:"FRONT_HAZCAM_RIGHT_A",REAR_HAZCAM_LEFT:"REAR_HAZCAM_LEFT",REAR_HAZCAM_RIGHT:"REAR_HAZCAM_RIGHT",SKYCAM:"SKYCAM",SHERLOC_WATSON:"SHERLOC_WATSON",FHAZ:"FHAZ",RHAZ:"RHAZ",MAST:"MAST",CHEMCAM:"CHEMCAM",MAHLI:"MAHLI",MARDI:"MARDI",NAVCAM:"NAV"};function Te(e){let a=0;for(let r=0;r<e.imageid.length;r++){const s=e.imageid.charCodeAt(r);a=(a<<5)-a+s,a=a&a}return{id:Math.abs(a),sol:e.sol,camera:{id:0,name:e.camera?.instrument||"Unknown",rover_id:5,full_name:e.camera?.instrument||"Unknown Camera"},img_src:e.image_files?.large||e.image_files?.medium||e.image_files?.full_res,earth_date:e.date_taken_utc?.split("T")[0]||"",rover:{id:5,name:"Perseverance",landing_date:"2021-02-18",launch_date:"2020-07-30",status:"active",max_sol:0,max_date:"",total_photos:0,cameras:[]}}}function Re(e){return{id:e.id,sol:e.sol,camera:{id:0,name:e.instrument||"Unknown",rover_id:4,full_name:e.instrument||"Unknown Camera"},img_src:e.url,earth_date:e.date_taken_utc?.split("T")[0]||e.created_at?.split("T")[0]||"",rover:{id:4,name:"Curiosity",landing_date:"2012-08-06",launch_date:"2011-11-26",status:"active",max_sol:0,max_date:"",total_photos:0,cameras:[]}}}async function Sa(e){const{rover:a}=e;if(a==="perseverance")return sa(e);if(a==="curiosity")return oa(e);if(a==="spirit"||a==="opportunity")return ia(e);throw new Error(`${a} data is not available`)}async function sa(e){const{sol:a,solMin:r,solMax:s,dateStart:u,dateEnd:i,camera:l,search:m,page:c=0}=e,o=new URLSearchParams({feed:"raw_images",category:"mars2020",feedtype:"json",num:"25",page:c.toString()});let n=2;a!==void 0?(o.set(`condition_${n++}`,`${a}:sol:gte`),o.set(`condition_${n++}`,`${a}:sol:lte`)):(r!==void 0&&o.set(`condition_${n++}`,`${r}:sol:gte`),s!==void 0&&o.set(`condition_${n++}`,`${s}:sol:lte`)),u&&o.set(`condition_${n++}`,`${u}:date_taken:gte`),i&&o.set(`condition_${n++}`,`${i}:date_taken:lte`);const x=[];l&&x.push(l),m&&x.push(m),x.length>0&&o.set("search",x.join(" "));const f=`${ke}?${o}`,v=await fetch(f);if(!v.ok)throw new Error(`NASA API error: ${v.status}`);return((await v.json()).images||[]).map(Te)}async function oa(e){const{sol:a,solMin:r,solMax:s,dateStart:u,dateEnd:i,camera:l,search:m,page:c=0}=e,o=new URLSearchParams({order:"sol desc,date_taken desc",per_page:"25",page:c.toString(),condition_1:"msl:mission"});let n=2;a!==void 0?(o.set(`condition_${n++}`,`${a}:sol:gte`),o.set(`condition_${n++}`,`${a}:sol:lte`)):(r!==void 0&&o.set(`condition_${n++}`,`${r}:sol:gte`),s!==void 0&&o.set(`condition_${n++}`,`${s}:sol:lte`)),u&&o.set(`condition_${n++}`,`${u}:date_taken:gte`),i&&o.set(`condition_${n++}`,`${i}:date_taken:lte`);const x=[];if(l){const R=na[l]||l;x.push(R)}m&&x.push(m),x.length>0&&o.set("search",x.join(" "));const f=`${Se}?${o}`,v=await fetch(f);if(!v.ok)throw new Error(`NASA API error: ${v.status}`);return((await v.json()).items||[]).map(Re)}async function ia(e){const{rover:a,sol:r,solMin:s,camera:u,page:i=0}=e;let l;r!==void 0?l=r:s!==void 0?l=s:l=1;const m=u||"PANCAM",c=new URLSearchParams({rover:a,sol:l.toString(),camera:m,page:i.toString()});try{const o=await fetch(`/api/mer?${c}`);if(!o.ok)throw new Error(`API error: ${o.status}`);return(await o.json()).photos||[]}catch(o){return console.error("Failed to fetch MER photos:",o),[]}}async function la(e){const a=new Date,s=new Date(a.getTime()-1440*60*1e3).toISOString().split("T")[0];if(e==="perseverance"){const u=new URLSearchParams({feed:"raw_images",category:"mars2020",feedtype:"json",num:"50",condition_2:`${s}:date_taken:gte`}),i=await fetch(`${ke}?${u}`);if(!i.ok)throw new Error(`NASA API error: ${i.status}`);return((await i.json()).images||[]).map(Te)}else if(e==="curiosity"){const u=new URLSearchParams({order:"sol desc,date_taken desc",per_page:"50",page:"0",condition_1:"msl:mission",condition_2:`${s}:date_taken:gte`}),i=await fetch(`${Se}?${u}`);if(!i.ok)throw new Error(`NASA API error: ${i.status}`);return((await i.json()).items||[]).map(Re)}throw new Error(`${e} data is no longer available`)}async function Ta(e){if(e==="spirit")return{max_sol:2208};if(e==="opportunity")return{max_sol:5111};try{const a=await la(e);if(a.length>0)return{max_sol:a[0].sol}}catch{}return e==="perseverance"?{max_sol:1400}:e==="curiosity"?{max_sol:4100}:{max_sol:0}}function ca(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown"}function fa(e){return`Sol ${e.toLocaleString()}`}var da=F('<img class="max-w-full max-h-[80vh] object-contain rounded-lg"/>'),va=F('<img class="max-w-full max-h-[80vh] object-contain rounded-lg"/>'),ua=F('<h2 class="text-xl font-semibold text-white"> </h2> <div class="space-y-3"><div><p class="text-gray-400 text-sm">Rover</p> <p class="text-white"> </p></div> <div><p class="text-gray-400 text-sm">Sol (Mars Day)</p> <p class="text-white"> </p></div> <div><p class="text-gray-400 text-sm">Earth Date</p> <p class="text-white"> </p></div> <div><p class="text-gray-400 text-sm">Camera</p> <p class="text-white"> </p></div></div> <div class="pt-4 border-t border-gray-700"><a target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 text-orange-400 hover:text-orange-300 transition-colors"><span>Open full resolution</span> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></a></div>',1),_a=F('<div><p class="text-gray-400 text-sm">Source</p> <p class="text-white"> </p></div>'),pa=F('<div><p class="text-gray-400 text-sm">Date</p> <p class="text-white"> </p></div>'),ha=F('<div><p class="text-gray-400 text-sm">Credits</p> <p class="text-white"> </p></div>'),ma=F('<div><p class="text-gray-400 text-sm">Description</p> <p class="text-white text-sm leading-relaxed"> </p></div>'),ga=F('<h2 class="text-xl font-semibold text-white"> </h2> <div class="space-y-3"><!> <!> <!> <!></div> <div class="pt-4 border-t border-gray-700"><a target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 text-orange-400 hover:text-orange-300 transition-colors"><span>Open full resolution</span> <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></a></div>',1),xa=F('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-4" role="dialog" aria-modal="true" aria-label="Image lightbox" tabindex="-1"><button type="button" class="absolute top-4 right-4 text-white/70 hover:text-white transition-colors z-10" aria-label="Close lightbox"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button> <div class="max-w-7xl max-h-full flex flex-col lg:flex-row gap-6 overflow-auto"><div class="flex-1 flex items-center justify-center"><!></div> <div class="lg:w-80 bg-gray-900/80 rounded-lg p-6 space-y-4 max-h-[80vh] overflow-y-auto"><!></div></div></div>');function Ra(e,a){We(a,!0);let r=Ae(a,"photo",3,null),s=Ae(a,"spaceImage",3,null),u=ue(()=>r()!==null),i=ue(()=>s()!==null),l=ue(()=>N(u)||N(i));function m(f){f.key==="Escape"&&a.onClose()}function c(f){f.target===f.currentTarget&&a.onClose()}var o=_e();ea("keydown",Je,m);var n=J(o);{var x=f=>{var v=xa();v.__click=c,v.__keydown=_=>_.key==="Enter"&&c(_);var S=p(v);S.__click=function(..._){a.onClose?.apply(this,_)};var R=w(S,2),t=p(R),d=p(t);{var D=_=>{var A=da();U(()=>{q(A,"src",r().img_src),q(A,"alt",`Mars surface from ${r().camera.full_name??""}`)}),T(_,A)},O=_=>{var A=_e(),g=J(A);{var G=k=>{var b=va();U(()=>{q(b,"src",s().img_src),q(b,"alt",s().title)}),T(k,b)};$(g,k=>{N(i)&&s()&&k(G)},!0)}T(_,A)};$(d,_=>{N(u)&&r()?_(D):_(O,!1)})}h(t);var y=w(t,2),L=p(y);{var Z=_=>{var A=ua(),g=J(A),G=p(g,!0);h(g);var k=w(g,2),b=p(k),B=w(p(b),2),se=p(B,!0);h(B),h(b);var V=w(b,2),W=w(p(V),2),oe=p(W,!0);h(W),h(V);var K=w(V,2),ee=w(p(K),2),ae=p(ee,!0);h(ee),h(K);var te=w(K,2),re=w(p(te),2),ie=p(re,!0);h(re),h(te),h(k);var X=w(k,2),le=p(X);h(X),U((E,M)=>{H(G,r().camera.full_name),H(se,r().rover.name),H(oe,E),H(ae,M),H(ie,r().camera.name),q(le,"href",r().img_src)},[()=>fa(r().sol),()=>ca(r().earth_date)]),T(_,A)},C=_=>{var A=_e(),g=J(A);{var G=k=>{var b=ga(),B=J(b),se=p(B,!0);h(B);var V=w(B,2),W=p(V);{var oe=E=>{var M=_a(),I=w(p(M),2),z=p(I,!0);h(I),h(M),U(()=>H(z,s().sourceDetails)),T(E,M)};$(W,E=>{s().sourceDetails&&E(oe)})}var K=w(W,2);{var ee=E=>{var M=pa(),I=w(p(M),2),z=p(I,!0);h(I),h(M),U(()=>H(z,s().date)),T(E,M)};$(K,E=>{s().date&&E(ee)})}var ae=w(K,2);{var te=E=>{var M=ha(),I=w(p(M),2),z=p(I,!0);h(I),h(M),U(()=>H(z,s().credits)),T(E,M)};$(ae,E=>{s().credits&&E(te)})}var re=w(ae,2);{var ie=E=>{var M=ma(),I=w(p(M),2),z=p(I,!0);h(I),h(M),U(()=>H(z,s().description)),T(E,M)};$(re,E=>{s().description&&E(ie)})}h(V);var X=w(V,2),le=p(X);h(X),U(()=>{H(se,s().title),q(le,"href",s().img_src)}),T(k,b)};$(g,k=>{N(i)&&s()&&k(G)},!0)}T(_,A)};$(L,_=>{N(u)&&r()?_(Z):_(C,!1)})}h(y),h(R),h(v),T(f,v)};$(n,f=>{N(l)&&f(x)})}T(e,o),Xe()}Qe(["click","keydown"]);export{Ra as L,ca as a,Sa as b,Ta as c,ka as e,fa as f,ya as i};
